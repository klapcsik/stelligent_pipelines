{
   "AWSTemplateFormatVersion":"2010-09-09",
   "Description":"Dromedary CodePipeline Custom Action Provisioning",
   "Parameters":{
      "MyInputArtifacts":{
         "Type":"String",
         "Default":"DromedarySource"
      },
      "MyBuildProvider":{
         "Type":"String"
      },
      "MyJenkinsURL":{
         "Type":"String"
      }
   },
   "Resources":{
      "MyCustomActionType":{
         "Type":"AWS::CodePipeline::CustomActionType",
         "Properties":{
            "Category":"Build",
            "Provider":{
               "Ref":"MyBuildProvider"
            },
            "Version":"1",
            "ConfigurationProperties":[
               {
                  "Description":"The name of the build project must be provided when this action is added to the pipeline.",
                  "Key":"true",
                  "Name":"ProjectName",
                  "Queryable":"true",
                  "Required":"true",
                  "Secret":"false",
                  "Type":"String"
               }
            ],
            "InputArtifactDetails":{
               "MaximumCount":"1",
               "MinimumCount":"1"
            },
            "OutputArtifactDetails":{
               "MaximumCount":"1",
               "MinimumCount":"0"
            },
            "Settings":{
               "EntityUrlTemplate":{
                  "Fn::Join":[
                     "https://",
                     [
                        {
                           "Ref":"MyJenkinsURL"
                        },
                        "/job/{Config:ProjectName}/"
                     ]
                  ]
               },
               "ExecutionUrlTemplate":{
                  "Fn::Join":[
                     "https://",
                     [
                        {
                           "Ref":"MyJenkinsURL"
                        },
                        "job/{Config:ProjectName}/lastSuccessfulBuild/{ExternalExecutionId}/"
                     ]
                  ]
               }
            }
         }
      }
   },
   "Outputs":{
      "CustomActionProvider":{
         "Description":"CodePipeline Custom action name",
         "Value":{
            "Ref":"MyCustomActionType"
         }
      }
   }
}